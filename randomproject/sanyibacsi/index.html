<!DOCTYPE html>
<?php
    $link = mysqli_connect("localhost", "root", "", "sanyi_bacsi_test");
?>
<html lang="en">
<head>
    
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="style.css">
    <link rel="icon" href="sanyibacsi.jfif">
    <title>Diáktartó</title>
</head>
<body>
    <div class="container">
        <div class="chosenStudent">
            <div class="studentData">
                <label>Mai órák:</label>
                <table class="data" id="dataTable">
                    <script>
                        const xmlhttp = new XMLHttpRequest();

                        xmlhttp.onload = function() {
                            const classToday = JSON.parse(this.responseText);
                            for (let i=0; i<=this.responseText.length;i++){
                                document.getElementById("dataTable").innerHTML += classToday[i].studentName+"-nak "+classToday[i].class+" órája lesz "+classToday[i].classStart+"-kor. <br>";
                            }
                            function plusZero(j){
                                if(j<10){
                                    j="0"+j;
                                }
                                return j
                            }   
                            for(let k=0; k<classToday.length; k++){
                                classToday[k].classStartart = classToday[k].classStart.split(".");
                                const then = new Date();
                                then.setHours(classToday[k].classStart[0], classToday[k].classStart[1]);
                                if(now<then){
                                    console.log(classToday[k]);
                                    const diff = (then-now)/60000;
                                    document.getElementById("nextStudentTime").innerHTML="A következő óráig "+diff+" perc van hátra;";
                                    document.getElementById("nextStudent").innerHTML="A diák akivel az óra lesz: "+classToday[k].studentName;
                                }
                                if(now.getTime()===then.getTime()){
                                    document.getElementById("randomDiv").innerHTML="A következő óra éppen most kezdődik.";
                                }
                                if(now>then){
                                    if(k===classToday.length){
                                        document.getElementById("randomDiv").innerHTML="A mai napra már nincs több óra.";
                                    }
                                }
                            }
                        }
                        xmlhttp.open("GET", "classes.php");
                        xmlhttp.send();
                    </script>
                </table>
                <div class="buttonWrapper">
                    <button class="chosenStudentCloser">OK</button>
                </div>
            </div>
            <div class="timeLeft">
                <p id="nextStudentTime">A következő óráig hátrelevő idő: blabla</p>
                <p id="nextStudent">Diák: Bla Bla</p>
            </div>
        </div>
        <div class="calendar">
            <div class="month">
                <pre class="monthPrev"><</pre>
            <div class="date">
                <h1>Május</h1>
                <p>Pén Máj 29, 2020</p>
            </div>
            <pre class="monthNext">></pre>
            </div>
            <div class="weekDays">
                <div>Vas</div>
                <div>Hét</div>
                <div>Kedd</div>
                <div>Szer</div>
                <div>Csüt</div>
                <div>Pén</div>
                <div>Szom</div>
            </div>
            <div class="days">
                
            </div>
        </div>
    </div>
    

    <script src="javascr.js"></script>
</body>
</html>